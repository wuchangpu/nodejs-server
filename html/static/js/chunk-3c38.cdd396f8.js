(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3c38"],{"35f/":function(e,t,r){"use strict";var a=r("RfF9");r.n(a).a},"94IF":function(e,t,r){"use strict";r.r(t);var a=r("6ZY3"),s=r.n(a),o=r("EPZ6"),n=r.n(o),l=r("cLjf"),i=r.n(l),c=r("hDQ3"),u=r.n(c),d=r("bS4n"),m=r.n(d),f=r("8t5x"),p={data:function(){var e=this;return{form:{username:"",roleId:"",status:"",timeBegin:"",timeEnd:"",pageNumber:1,pageSize:20},tableData:[],total:0,roleList:[],batchDelIds:[],dialogTitle:"",centerDialogVisible:!1,addForm:{jobNumber:"",username:"",idCard:"",mobile:"",roleIdList:[]},rules:{jobNumber:[{required:!0,message:"请输入工号",trigger:"change"},{validator:function(t,r,a){r?e.$reg.jobNumber.test(r)?a():a(new Error("工号格式不正确")):a(new Error("请输入工号"))},trigger:"blur"}],username:[{required:!0,message:"请输入姓名",trigger:"change"},{required:!0,message:"请输入姓名",trigger:"blur"}],idCard:[{required:!0,message:"请输入身份证号码",trigger:"change"},{validator:function(t,r,a){r?e.$reg.idCard.test(r)?a():a(new Error("身份证号码格式不正确")):a(new Error("请输入身份证号码"))},trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号码",trigger:"change"},{validator:function(t,r,a){r?e.$reg.phone.test(r)?a():a(new Error("手机号码格式不正确")):a(new Error("请输入手机号码"))},trigger:"blur"}],roleIdList:[{required:!0,message:"请选择角色",trigger:"blur"}]},curClickItemIndex:-1}},computed:m()({},Object(f.b)(["userInfo"])),created:function(){this.getTableData(),this.getRoleList()},methods:{getTableData:function(){var e=this;return u()(i.a.mark(function t(){var r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$post("sysUserList",e.form);case 2:"1000"===(r=t.sent).returnCode?(e.tableData=r.records,e.total=+r.total):e.$message.error(r.message);case 4:case"end":return t.stop()}},t,e)}))()},getRoleList:function(){var e=this;return u()(i.a.mark(function t(){var r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$post("sysRoleSelect",{});case 2:"1000"===(r=t.sent).returnCode?e.roleList=r.dataInfo:e.$message.error(r.message);case 4:case"end":return t.stop()}},t,e)}))()},changeAdministratorStatus:function(e,t){var r=this;return u()(i.a.mark(function a(){var s;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.$post("sysUserIsEnable",{userId:t.row.userId});case 2:"1000"===(s=a.sent).returnCode?r.$message.success("“"+t.row.username+"”状态已"+("1"===e?"启用":"2"===e?"禁用":"")):(r.tableData[t.$index].status="1"===e?"2":"2"===e?"1":"",r.$message.error(s.message));case 4:case"end":return a.stop()}},a,r)}))()},search:function(){this.form.pageNumber=1,this.getTableData()},handleSelectionChange:function(e){this.batchDelIds=e.map(function(e){return e.userId})},addAdministratorClick:function(){this.addForm={jobNumber:"",username:"",idCard:"",mobile:"",roleIdList:[]},this.dialogTitle="新增管理员",this.centerDialogVisible=!0},batchDel:function(){var e=this,t=this.tableData.filter(function(t){return e.batchDelIds.includes(t.userId)}).map(function(e){return e.username});this.$confirm("此操作将删除管理员 “"+t.join("、")+"” , 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.delAdministrator(e.batchDelIds)}).catch(function(){})},editTableItem:function(e){this.curClickItemIndex=e.$index,this.getAdministrator(e.row.userId)},getAdministrator:function(e){var t=this;return u()(i.a.mark(function r(){var a;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$post("sysUserQuerUserinfo",{userId:e});case 2:"1000"===(a=r.sent).returnCode?(n()(t.addForm).forEach(function(e){t.addForm[e]=a.dataInfo[e]}),t.dialogTitle="编辑管理员",t.centerDialogVisible=!0):t.$message.error(a.message);case 4:case"end":return r.stop()}},r,t)}))()},delTableItem:function(e){var t=this;this.curClickItemIndex=e.$index,this.$confirm("此操作将删除管理员 “"+e.row.username+"” , 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.delAdministrator([e.row.userId])}).catch(function(){})},delAdministrator:function(e){var t=this;return u()(i.a.mark(function r(){var a;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$post("sysUserDelete",{idList:e});case 2:"1000"===(a=r.sent).returnCode?(t.$message.success("删除成功"),t.tableData=t.tableData.filter(function(t){return!e.includes(t.userId)}),t.total-=e.length):t.$message.error(a.message);case 4:case"end":return r.stop()}},r,t)}))()},paginationChange:function(e){this.form.pageNumber=e.page,this.form.pageSize=e.limit,this.getTableData()},closeDialog:function(e){this.centerDialogVisible=!1,this.$refs[e].clearValidate()},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;"新增管理员"===t.dialogTitle?t.addAdministrator():"编辑管理员"===t.dialogTitle&&t.editAdministrator()})},addAdministrator:function(){var e=this;return u()(i.a.mark(function t(){var r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$post("sysUserSave",e.addForm);case 2:"1000"===(r=t.sent).returnCode?(e.$message.success("新增成功"),e.centerDialogVisible=!1,e.search()):e.$message.error(r.message);case 4:case"end":return t.stop()}},t,e)}))()},editAdministrator:function(){var e=this;return u()(i.a.mark(function t(){var r,a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.tableData[e.curClickItemIndex].userId,t.next=3,e.$post("sysUserUpdate",s()({},e.addForm,{userId:r}));case 3:"1000"===(a=t.sent).returnCode?(e.$message.success("修改成功"),e.centerDialogVisible=!1,e.search(),e.userInfo.user.userId==r&&(n()(e.addForm).forEach(function(t){e.userInfo.user[t]=e.addForm[t]}),e.userInfo.user.roleName=e.getRoleNames(e.addForm.roleIdList),e.$store.dispatch("setUserInfo",e.userInfo))):e.$message.error(a.message);case 5:case"end":return t.stop()}},t,e)}))()},getRoleNames:function(e){return this.roleList.filter(function(t){return e.includes(t.roleId)}).map(function(e){return e.roleName}).join(",")}}},b=(r("35f/"),r("ZrdR")),g=Object(b.a)(p,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"permission_administrator"},[r("div",{staticClass:"roles_wrapper"},[r("el-form",{ref:"form",staticClass:"form",attrs:{model:e.form,"label-width":"120px"}},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"姓名/工号："}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"角色："}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",clearable:""},model:{value:e.form.roleId,callback:function(t){e.$set(e.form,"roleId",t)},expression:"form.roleId"}},e._l(e.roleList,function(e,t){return r("el-option",{key:"roleList"+t,attrs:{label:e.roleName,value:e.roleId}})}))],1)],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"状态："}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",clearable:""},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[r("el-option",{attrs:{label:"启用",value:"1"}}),e._v(" "),r("el-option",{attrs:{label:"禁用",value:"2"}})],1)],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:16}},[r("el-form-item",{attrs:{label:"更新时间："}},[r("el-col",{attrs:{span:11}},[r("date-picker",{attrs:{fullWidth:""},model:{value:e.form.timeBegin,callback:function(t){e.$set(e.form,"timeBegin",t)},expression:"form.timeBegin"}})],1),e._v(" "),r("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),e._v(" "),r("el-col",{attrs:{span:11}},[r("date-picker",{attrs:{fullWidth:"",end:""},model:{value:e.form.timeEnd,callback:function(t){e.$set(e.form,"timeEnd",t)},expression:"form.timeEnd"}})],1)],1)],1)],1),e._v(" "),r("el-row",{staticClass:"search_button_row"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.search}},[e._v("搜索")])],1)],1),e._v(" "),r("div",{staticClass:"roles_container"},[r("div",{staticClass:"btn_container"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addAdministratorClick}},[e._v("新增管理员")]),e._v(" "),r("el-button",{attrs:{size:"mini"},on:{click:e.batchDel}},[e._v("批量删除")])],1),e._v(" "),r("el-table",{ref:"roleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection"}}),e._v(" "),r("el-table-column",{attrs:{prop:"username",label:"姓名"}}),e._v(" "),r("el-table-column",{attrs:{prop:"jobNumber",label:"工号"}}),e._v(" "),r("el-table-column",{attrs:{prop:"idCard",label:"身份证","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"roleName",label:"角色","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"mobile",label:"联系方式","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{label:"状态",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{staticStyle:{display:"block"},attrs:{"active-value":"1","inactive-value":"2","inactive-color":"#ccc","active-text":"启用","inactive-text":"禁用"},on:{change:function(r){e.changeAdministratorStatus(r,t)}},model:{value:t.row.status,callback:function(r){e.$set(t.row,"status",r)},expression:"scope.row.status"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("filterTime")(t.row.updatedTime,"YYYY-MM-DD hh:mm")))]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"address",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticClass:"edit_item",on:{click:function(r){e.editTableItem(t)}}},[e._v("编辑")]),e._v(" "),e.userInfo.user.userId!=t.row.userId?r("span",{staticClass:"del_item",on:{click:function(r){e.delTableItem(t)}}},[e._v("删除")]):e._e()]}}])})],1)],1),e._v(" "),r("div",{staticClass:"pagination"},[r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.form.pageNumber,limit:e.form.pageSize},on:{"update:page":function(t){e.$set(e.form,"pageNumber",t)},"update:limit":function(t){e.$set(e.form,"pageSize",t)},pagination:e.paginationChange}})],1),e._v(" "),r("div",{staticClass:"dialog-container"},[r("el-dialog",{attrs:{title:e.dialogTitle,visible:e.centerDialogVisible,center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[r("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.rules,"label-width":"120px"}},[r("el-row",[r("el-col",{attrs:{span:21}},[r("el-form-item",{attrs:{label:"工号：",prop:"jobNumber"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addForm.jobNumber,callback:function(t){e.$set(e.addForm,"jobNumber",t)},expression:"addForm.jobNumber"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:21}},[r("el-form-item",{attrs:{label:"姓名：",prop:"username"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addForm.username,callback:function(t){e.$set(e.addForm,"username",t)},expression:"addForm.username"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:21}},[r("el-form-item",{attrs:{label:"身份证号：",prop:"idCard"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addForm.idCard,callback:function(t){e.$set(e.addForm,"idCard",t)},expression:"addForm.idCard"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:21}},[r("el-form-item",{attrs:{label:"联系方式：",prop:"mobile"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addForm.mobile,callback:function(t){e.$set(e.addForm,"mobile",t)},expression:"addForm.mobile"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:21}},[r("el-form-item",{attrs:{label:"角色：",prop:"roleIdList"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择",clearable:""},model:{value:e.addForm.roleIdList,callback:function(t){e.$set(e.addForm,"roleIdList",t)},expression:"addForm.roleIdList"}},e._l(e.roleList,function(e,t){return r("el-option",{key:t,attrs:{label:e.roleName,value:e.roleId}})}))],1)],1)],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.closeDialog("addForm")}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("addForm")}}},[e._v("确 定")])],1)],1)],1)],1)])},[],!1,null,"29ffbb8b",null);g.options.__file="list.vue";t.default=g.exports},RfF9:function(e,t,r){}}]);