(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-265a"],{HGGC:function(e,t,s){"use strict";var r={},a=(s("eD7o"),s("ZrdR")),o=Object(a.a)(r,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login_nav"},[r("el-row",{staticClass:"top"},[r("el-col",{attrs:{span:15}},[r("div",{staticClass:"logo_contianer"},[r("img",{staticClass:"logo",attrs:{src:s("zwU1"),alt:"logo"}}),e._v(" "),r("span",{staticClass:"text_left"},[e._v("智慧华中大")]),e._v(" "),r("span",{staticClass:"text_center"}),e._v(" "),r("span",{staticClass:"text_right"},[e._v("招生宣传干部管理系统（测试）")])])]),e._v(" "),r("el-col",{staticClass:"avatar_container",attrs:{span:9}},[r("div",{staticClass:"avatar_wrapper"},[r("span",{staticClass:"today"},[e._v("今日访问量：3301")]),e._v(" "),r("span",{staticClass:"total"},[e._v("总访问量：700.33万")])])])],1)],1)},[],!1,null,"e3e92376",null);o.options.__file="index.vue";t.a=o.exports},d3e1:function(e,t,s){},eD7o:function(e,t,s){"use strict";var r=s("d3e1");s.n(r).a},"fd/D":function(e,t,s){},h9gA:function(e,t,s){"use strict";s.r(t);var r=s("cLjf"),a=s.n(r),o=s("hDQ3"),n=s.n(o),i=s("bS4n"),c=s.n(i),l=s("HGGC"),u=s("8t5x"),p={name:"init-password",components:{LoginNav:l.a},data:function(){var e=this;return{stepOneForm:{jobNumber:""},stepTwoForm:{username:"",idCard:""},stepThreeForm:{newPassword:"",repeatPassword:""},rules:{jobNumber:[{required:!0,message:"请输入工号",trigger:"change"},{validator:function(t,s,r){s?e.$reg.jobNumber.test(s)?r():r(new Error("工号格式不正确")):r(new Error("请输入工号"))},trigger:"blur"}],username:[{required:!0,message:"请输入姓名",trigger:"change"}],idCard:[{required:!0,message:"请输入身份证号码",trigger:"change"},{validator:function(t,s,r){s?e.$reg.idCard.test(s)?r():r(new Error("身份证号码格式不正确")):r(new Error("请输入身份证号码"))},trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"change"},{validator:function(t,s,r){s?e.$reg.psd.test(s)?r():r(new Error("请输入8-20位字母、数字或符号的密码")):r(new Error("请输入新密码"))},trigger:"blur"}],repeatPassword:[{required:!0,message:"请再次输入新密码",trigger:"change"},{validator:function(t,s,r){s?s!==e.stepThreeForm.newPassword?r(new Error("两次输入密码不一致!")):r():r(new Error("请再次输入新密码"))},trigger:"blur"}]}}},computed:c()({},Object(u.b)(["initPsdStatus"]),{active:function(){return+(""===this.initPsdStatus||void 0===this.initPsdStatus?0:this.initPsdStatus)}}),created:function(){console.log("active",this.active,this.initPsdStatus),sessionStorage.getItem("initPsdJobNum")&&(this.stepOneForm.jobNumber=sessionStorage.getItem("initPsdJobNum"))},methods:{previous:function(){this.$store.dispatch("setInitPsdStatus",this.initPsdStatus-1)},next:function(){switch(this.active){case 0:this.submitForm("stepOneForm");break;case 1:this.submitForm("stepTwoForm");break;case 2:this.submitForm("stepThreeForm")}},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.warn("有信息未填写"),!1;switch(t.active){case 0:t.checkJobNumber();break;case 1:t.checkIdentity();break;case 2:t.initPassword()}})},checkJobNumber:function(){var e=this;return n()(a.a.mark(function t(){var s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$post("sysCheckJobNumber",e.stepOneForm);case 2:"1000"===(s=t.sent).returnCode?(sessionStorage.setItem("initPsdJobNum",e.stepOneForm.jobNumber),e.$store.dispatch("setInitPsdStatus",+e.initPsdStatus+1)):e.$message.error(s.message);case 4:case"end":return t.stop()}},t,e)}))()},checkIdentity:function(){var e=this;return n()(a.a.mark(function t(){var s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$post("sysCheckIdCard",e.stepTwoForm);case 2:"1000"===(s=t.sent).returnCode?(sessionStorage.setItem("initPsdUserId",s.dataInfo.userId),e.$store.dispatch("setInitPsdStatus",+e.initPsdStatus+1)):e.$message.error(s.message);case 4:case"end":return t.stop()}},t,e)}))()},initPassword:function(){var e=this;return n()(a.a.mark(function t(){var s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$post("sysInitPassword",{userId:sessionStorage.getItem("initPsdUserId"),password:e.$md5(e.stepThreeForm.newPassword)});case 2:"1000"===(s=t.sent).returnCode?(e.$message.success("初始化密码成功"),e.$router.replace("/login")):e.$message.error(s.message);case 4:case"end":return t.stop()}},t,e)}))()}}},m=(s("xI6C"),s("ZrdR")),d=Object(m.a)(p,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"init_password"},[s("login-nav"),e._v(" "),s("div",{staticClass:"container"},[s("p",{staticClass:"title"},[e._v("初始化密码/找回密码")]),e._v(" "),s("div",{staticClass:"content"},[s("el-row",{staticClass:"step_container"},[s("el-steps",{attrs:{active:e.active,"finish-status":"success","process-status":"finish","align-center":""}},[s("el-step",{attrs:{title:"填写工号"}}),e._v(" "),s("el-step",{attrs:{title:"验证"}}),e._v(" "),s("el-step",{attrs:{title:"重置密码"}})],1)],1),e._v(" "),s("el-row",[s("el-form",{directives:[{name:"show",rawName:"v-show",value:0===e.active,expression:"active === 0"}],ref:"stepOneForm",staticClass:"form",attrs:{model:e.stepOneForm,rules:e.rules,"label-width":"120px"}},[s("el-row",[s("el-col",{attrs:{span:12,offset:5}},[s("el-form-item",{attrs:{label:"工号：",prop:"jobNumber"}},[s("el-input",{attrs:{"auto-complete":"on",placeholder:"人员编号（10位）/学号（ID）"},model:{value:e.stepOneForm.jobNumber,callback:function(t){e.$set(e.stepOneForm,"jobNumber","string"==typeof t?t.trim():t)},expression:"stepOneForm.jobNumber"}})],1)],1)],1)],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:1===e.active,expression:"active === 1"}],ref:"stepTwoForm",staticClass:"form",attrs:{model:e.stepTwoForm,rules:e.rules,"label-width":"120px"}},[s("el-row",[s("el-col",{attrs:{span:12,offset:5}},[s("el-form-item",{attrs:{label:"工号："}},[e._v("\n                "+e._s(e.stepOneForm.jobNumber)+"\n              ")])],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:12,offset:5}},[s("el-form-item",{attrs:{label:"姓名：",prop:"username"}},[s("el-input",{attrs:{"auto-complete":"on",placeholder:"请输入姓名"},model:{value:e.stepTwoForm.username,callback:function(t){e.$set(e.stepTwoForm,"username","string"==typeof t?t.trim():t)},expression:"stepTwoForm.username"}})],1)],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:12,offset:5}},[s("el-form-item",{attrs:{label:"身份证号：",prop:"idCard"}},[s("el-input",{attrs:{"auto-complete":"on",placeholder:"请输入身份证号"},model:{value:e.stepTwoForm.idCard,callback:function(t){e.$set(e.stepTwoForm,"idCard","string"==typeof t?t.trim():t)},expression:"stepTwoForm.idCard"}})],1)],1)],1)],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:2===e.active||3===e.active,expression:"active === 2 || active === 3"}],ref:"stepThreeForm",staticClass:"form",attrs:{model:e.stepThreeForm,rules:e.rules,"label-width":"120px"}},[s("el-row",[s("el-col",{attrs:{span:12,offset:5}},[s("el-form-item",{attrs:{label:"新密码：",prop:"newPassword"}},[s("el-input",{attrs:{"auto-complete":"on",placeholder:"请输入新密码"},model:{value:e.stepThreeForm.newPassword,callback:function(t){e.$set(e.stepThreeForm,"newPassword","string"==typeof t?t.trim():t)},expression:"stepThreeForm.newPassword"}})],1)],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:12,offset:5}},[s("el-form-item",{attrs:{label:"确认新密码：",prop:"repeatPassword"}},[s("el-input",{attrs:{"auto-complete":"on",placeholder:"请再次输入新密码"},model:{value:e.stepThreeForm.repeatPassword,callback:function(t){e.$set(e.stepThreeForm,"repeatPassword","string"==typeof t?t.trim():t)},expression:"stepThreeForm.repeatPassword"}})],1)],1)],1)],1)],1),e._v(" "),s("el-row",{staticClass:"btn_contianer"},[s("el-button",{directives:[{name:"show",rawName:"v-show",value:0!=e.active,expression:"active != 0"}],attrs:{size:"small"},on:{click:e.previous}},[e._v("上一步")]),e._v(" "),s("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.next}},[e._v(e._s(2===e.active?"完成":"下一步"))])],1)],1)])],1)},[],!1,null,"02f38fde",null);d.options.__file="index.vue";t.default=d.exports},xI6C:function(e,t,s){"use strict";var r=s("fd/D");s.n(r).a}}]);