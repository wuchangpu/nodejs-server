(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-447f"],{"2pW9":function(e,t,i){},"8W+b":function(e,t,i){"use strict";var o=i("EDtn");i.n(o).a},EDtn:function(e,t,i){},IqDQ:function(e,t,i){"use strict";var o=i("2pW9");i.n(o).a},W17D:function(e,t,i){"use strict";i.r(t);var o=i("cLjf"),r=i.n(o),n=i("hDQ3"),a=i.n(n),s={components:{commonAdd:i("po0U").a},data:function(){return{form:{}}},methods:{addRequest:function(e){var t=this;return a()(r.a.mark(function i(){var o;return r.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t.$post("addCircular",e);case 2:if("1000"!==(o=i.sent).returnCode){i.next=8;break}t.$message.success("新增成功"),t.$router.go(-1),i.next=9;break;case 8:return i.abrupt("return",t.$message.error(o.message));case 9:case"end":return i.stop()}},i,t)}))()}}},l=(i("8W+b"),i("ZrdR")),m=Object(l.a)(s,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"meet_add"},[t("common-add",{on:{addRequest:this.addRequest}})],1)},[],!1,null,"267c01e8",null);m.options.__file="add.vue";t.default=m.exports},bHdM:function(e,t,i){},czyE:function(e,t,i){"use strict";var o=i("bHdM");i.n(o).a},po0U:function(e,t,i){"use strict";var o=i("cLjf"),r=i.n(o),n=i("hDQ3"),a=i.n(n),s=i("6ZY3"),l=i.n(s),m={data:function(){return{pickerOptions:{disabledDate:function(e){var t=new Date;return e<(t=new Date(t.setDate(t.getDate()-1)))}},form:{title:"",content:"",informType:"1",needReply:"2",informTimely:"2",needSignIn:"2",columnName:"",columnType:"",fileName:"",filePath:"",optionList:[{id:"",option:""}],hintTime:"",searchSite:"",site:"",scop:"",longitude:"",dimensionality:"",period:"",download:"",publishTime:"",informWayList:[]},option:"",limit:1,accept:"",relus:{title:[{required:!0,message:"请输入标题",trigger:"blur"},{min:1,max:200,message:"长度在 1 到 200 个字符",trigger:"blur"}],columnName:[{required:!0}],content:[{required:!0,message:"请输入正文",trigger:"blur"}],informType:[{required:!0,message:"请选择通知对象",trigger:"blur"}],period:[{required:!0,message:"请选择公示有效期",trigger:"blur"}],publishTime:[{validator:function(e,t,i){if(t){var o=(new Date).getTime();t<(o+=36e5)?i(new Error("只能选择当前时间1个小时之后的时间")):i()}else i()},trigger:"change"}]},optionIndex:"",itemDisplay:!0,setTxt:"通知设置:",moveUrl:"",nameArr:[],pathArr:[],setObjId:[],mapCenter:[],mapRange:"",dataEntityList:[],timeNow:""}},props:{type:{type:String,default:"1"}},methods:{getMapInfo:function(e){this.form.searchSite=e.searchText,this.form.site=e.address,this.form.scop=e.radius,this.form.longitude=e.center.lng,this.form.dimensionality=e.center.lat},uniq:function(e){for(var t=[],i=0;i<e.length;i++)e.indexOf(e[i])==i&&t.push(e[i]);return t},arrTest:function(e,t){for(var i={},o=0;o<e.length;o++){if(i[e[o][t]])return!1;i[e[o][t]]=e[o]}return i},selected:function(e,t){this.dataEntityList.forEach(function(i){e==i.dataValue&&(t.id=i.dataKey)})},submitForm:function(e,t){var i=this;return 2==this.form.needReply&&(this.form.optionList=[]),1==this.form.informTimely?this.form.hintTime=this.form.hintTime:this.form.hintTime="","1"!=this.form.informTimely||this.form.hintTime?"1"==this.form.informTimely&&0==this.form.informWayList.length?this.$message.error("请选择提示方式"):(1==this.form.needSignIn?(this.form.site=this.form.site,this.form.scop=this.form.scop):(this.form.site="",this.form.scop=""),this.setObjId||"1"===this.form.informType?("2"===this.form.informType?this.form.orgList=this.setObjId:"3"===this.form.informType?this.form.roleList=this.setObjId:"4"===this.form.informType&&(this.form.userList=this.setObjId),this.arrTest(this.form.optionList,"id")?void this.$refs[e].validate(function(e){return e?!("1"===i.form.needSignIn&&!i.$refs.checkInMap.validate())&&void i.$emit("addRequest",l()({},i.form,{content:i.$base64.encode(i.form.content),columnType:i.type,status:t.status,saveStatus:t.status,scop:i.form.scop})):(console.log("error submit!!"),!1)}):this.$message.error("反馈不能有重复的选项")):this.$message.error("通知对象人员未勾选")):this.$message.error("请选择提示时间")},radioClick:function(e,t){this.form.informType!==t&&this.$refs.person.clearCheckbox()},getFiles:function(e){this.nameArr.push(e.fileName),this.pathArr.push(e.filePath),this.form.fileName=this.nameArr.join(","),this.form.filePath=this.pathArr.join(",")},removeFile:function(e){var t=e.file.name,i=this.form.fileName.split(","),o=i.indexOf(t);i.splice(o,1);this.form.fileName=i.join(",");var r=e.file.url,n=this.form.filePath.split(","),a=n.indexOf(r);n.splice(a,1);this.form.filePath=n.join(",")},abolish:function(){this.$router.go(-1)},columnName:function(){var e="";switch(this.type){case"1":e="会议通知";break;case"2":e="培训通知";break;case"3":e="系统通知";break;case"4":e="文件公示"}return this.form.columnName=e,e},moreOption:function(){this.form.optionList.push({option:"",id:""})},delopt:function(e){this.form.optionList.splice(e,1)},init:function(){var e=this;return a()(r.a.mark(function t(){var i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return 3==e.type&&(e.itemDisplay=!1),4==e.type?(e.setTxt="公告设置：",e.limit=1,e.accept="application/pdf"):e.limit=1e3,t.next=4,e.getDictionaryData(["1012_hfxx"]);case 4:i=t.sent,e.dataEntityList=i[0].dataEntityList;case 6:case"end":return t.stop()}},t,e)}))()}},created:function(){this.init()}},c=(i("IqDQ"),i("czyE"),i("ZrdR")),f=Object(c.a)(m,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"commonAdd"},[i("div",{staticClass:"addinform"},[i("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.relus,"label-width":"110px"}},[i("el-row",[i("el-col",{attrs:{span:6}},[i("el-form-item",{attrs:{label:"标题:",prop:"title"}},[i("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-form-item",{attrs:{label:"栏目:",prop:"columnName"}},[i("span",[e._v(e._s(e.columnName()))])])],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-form-item",{attrs:{label:"发布时间:",prop:"publishTime"}},[i("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择","value-format":"timestamp","picker-options":e.pickerOptions},model:{value:e.form.publishTime,callback:function(t){e.$set(e.form,"publishTime",t)},expression:"form.publishTime"}})],1)],1),e._v(" "),4==e.type?i("el-col",{attrs:{span:6}},[i("el-form-item",{attrs:{label:"公示有效期:",prop:"period"}},[i("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择","value-format":"timestamp"},model:{value:e.form.period,callback:function(t){e.$set(e.form,"period",t)},expression:"form.period"}})],1)],1):e._e()],1),e._v(" "),4!=e.type?i("el-form-item",{staticClass:"item_label",attrs:{label:"正文:",prop:"content"}},[i("tinymce",{model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"上传文件:"}},[i("file-upload",{attrs:{limit:e.limit,accept:e.accept},on:{getFiles:e.getFiles,removeFile:e.removeFile}})],1),e._v(" "),i("el-form-item",{staticClass:"item_label notify_object",attrs:{label:e.setTxt,prop:"informType"}},[4==e.type?i("span",[e._v("公示对象：")]):i("span",[e._v("通知对象：")]),e._v(" "),i("el-radio-group",{model:{value:e.form.informType,callback:function(t){e.$set(e.form,"informType",t)},expression:"form.informType"}},[i("el-radio",{attrs:{label:"1"},nativeOn:{click:function(t){e.radioClick(t,"1")}}},[e._v("全部成员")]),e._v(" "),i("el-radio",{attrs:{label:"2"},nativeOn:{click:function(t){e.radioClick(t,"2")}}},[e._v("指定招生组")]),e._v(" "),i("el-radio",{attrs:{label:"3"},nativeOn:{click:function(t){e.radioClick(t,"3")}}},[e._v("指定角色")]),e._v(" "),i("el-radio",{attrs:{label:"4"},nativeOn:{click:function(t){e.radioClick(t,"4")}}},[e._v("自定义成员")])],1)],1),e._v(" "),i("specified-object",{ref:"person",attrs:{type:e.form.informType},model:{value:e.setObjId,callback:function(t){e.setObjId=t},expression:"setObjId"}}),e._v(" "),e.itemDisplay?i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:4!=e.type,expression:"type != 4"}],attrs:{label:"是否需反馈:"}},[i("el-radio",{attrs:{label:"2"},model:{value:e.form.needReply,callback:function(t){e.$set(e.form,"needReply",t)},expression:"form.needReply"}},[e._v("否")]),e._v(" "),i("el-radio",{attrs:{label:"1"},model:{value:e.form.needReply,callback:function(t){e.$set(e.form,"needReply",t)},expression:"form.needReply"}},[e._v("是")]),e._v(" "),1==e.form.needReply?i("div",{staticClass:"feedback"},[e._l(e.form.optionList,function(t,o){return i("p",{key:o},[e._v("\n            选项"+e._s(o+1)+"：\n            "),e._v(" "),i("el-select",{attrs:{placeholder:"请选择",clearable:""},on:{change:function(i){e.selected(i,t)}},model:{value:t.option,callback:function(i){e.$set(t,"option",i)},expression:"val.option"}},e._l(e.dataEntityList,function(e){return i("el-option",{key:e.dataKey,attrs:{label:e.dataValue,value:e.dataValue}})})),e._v(" "),0!=o?i("i",{staticClass:"el-icon-circle-close",staticStyle:{color:"red","margin-left":"5px"},on:{click:function(t){e.delopt(o)}}}):e._e()],1)}),e._v(" "),i("el-button",{staticStyle:{width:"250px"},attrs:{type:"submit"},on:{click:e.moreOption}},[e._v("＋添加更多选项")])],2):e._e()],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"是否及时通知:"}},[i("el-radio",{attrs:{label:"2"},model:{value:e.form.informTimely,callback:function(t){e.$set(e.form,"informTimely",t)},expression:"form.informTimely"}},[e._v("否")]),e._v(" "),i("el-radio",{attrs:{label:"1"},model:{value:e.form.informTimely,callback:function(t){e.$set(e.form,"informTimely",t)},expression:"form.informTimely"}},[e._v("是")]),e._v(" "),1==e.form.informTimely?i("div",{staticClass:"block notifytime"},[i("span",{staticClass:"demonstration"},[e._v("提示时间:")]),e._v(" "),i("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间","value-format":"timestamp"},model:{value:e.form.hintTime,callback:function(t){e.$set(e.form,"hintTime",t)},expression:"form.hintTime"}})],1):e._e(),e._v(" "),1==e.form.informTimely?i("div",{staticClass:"block notifytime"},[i("span",{staticClass:"demonstration"},[e._v("提示方式:")]),e._v(" "),i("el-checkbox-group",{model:{value:e.form.informWayList,callback:function(t){e.$set(e.form,"informWayList",t)},expression:"form.informWayList"}},[i("el-checkbox",{attrs:{label:"1"}},[e._v("短信")]),e._v(" "),i("el-checkbox",{attrs:{label:"2"}},[e._v("微信")])],1)],1):e._e()],1),e._v(" "),e.itemDisplay?i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:4!=e.type,expression:"type != 4"}],attrs:{label:"是否需签到:"}},[i("el-radio",{attrs:{label:"2"},model:{value:e.form.needSignIn,callback:function(t){e.$set(e.form,"needSignIn",t)},expression:"form.needSignIn"}},[e._v("否")]),e._v(" "),i("el-radio",{attrs:{label:"1"},model:{value:e.form.needSignIn,callback:function(t){e.$set(e.form,"needSignIn",t)},expression:"form.needSignIn"}},[e._v("是")])],1):e._e(),e._v(" "),i("check-in-map",{ref:"checkInMap",attrs:{showMap:e.itemDisplay&&"1"===e.form.needSignIn},on:{complete:e.getMapInfo}}),e._v(" "),4==e.type?i("el-form-item",{attrs:{label:"是否可下载文件:","label-width":"120px"}},[i("el-radio",{attrs:{label:"2"},model:{value:e.form.download,callback:function(t){e.$set(e.form,"download",t)},expression:"form.download"}},[e._v("否")]),e._v(" "),i("el-radio",{attrs:{label:"1"},model:{value:e.form.download,callback:function(t){e.$set(e.form,"download",t)},expression:"form.download"}},[e._v("是")])],1):e._e()],1),e._v(" "),i("div",{staticClass:"btn_group"},[i("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){e.submitForm("ruleForm",{status:2})}}},[e._v("确定")]),e._v(" "),i("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.submitForm("ruleForm",{status:1})}}},[e._v("暂存")]),e._v(" "),i("el-button",{attrs:{type:"submit"},on:{click:e.abolish}},[e._v("取消")])],1)],1)])},[],!1,null,"685594f4",null);f.options.__file="commonAdd.vue";t.a=f.exports}}]);