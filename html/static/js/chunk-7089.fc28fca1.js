(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7089"],{"13ok":function(e,t,a){"use strict";a.r(t);var r=a("EPZ6"),i=a.n(r),n=a("6ZY3"),s=a.n(n),o=a("cLjf"),l=a.n(o),d=a("hDQ3"),c=a.n(d),m=(a("8t5x"),{name:"commit-record-list",data:function(){return{form:{title:"",assignObject:"",pageNumber:1,pageSize:20},tableData:[],total:0,batchDelIds:[],dialogTitle:"",centerDialogVisible:!1,addForm:{title:"",eventBegin:"",eventEnd:"",assignObject:"",content:"",orgIdList:[],informWayList:[],informTimely:"",hintTime:""},backupAddForm:"",rules:{title:[{required:!0,message:"请输入标题",trigger:"change"}],eventBegin:[{required:!0,message:"请选择开始时间",trigger:"change"}],eventEnd:[{required:!0,message:"请选择结束时间",trigger:"change"}],assignObject:[{required:!0,message:"请选择指定提交对象型",trigger:"change"}],orgIdList:[{required:!0,message:"请选择指定招生组",trigger:"change"}],informWayList:[{required:!0,message:"请选择提示方式",trigger:"change"}],informTimely:[{required:!0,message:"请选择是否及时通知",trigger:"change"}],hintTime:[{required:!0,message:"请选择通知时间",trigger:"change"}]},curClickItemIndex:-1,admissionsTeamList:[]}},computed:{disabled:function(){return"编辑提交设置"===this.dialogTitle}},created:function(){this.backupAddForm=this.$deepCopy(this.addForm),this.getTableData(),this.getAdmissionsTeamList()},methods:{getTableData:function(){var e=this;return c()(l.a.mark(function t(){var a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$post("summarizePage",e.form);case 2:"1000"===(a=t.sent).returnCode?(e.tableData=a.records,e.total=+a.total):e.$message.error(a.message);case 4:case"end":return t.stop()}},t,e)}))()},getAdmissionsTeamList:function(){var e=this;return c()(l.a.mark(function t(){var a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$post("adminssionGroupList",e.admissionsTeamParams);case 2:"1000"===(a=t.sent).returnCode?e.admissionsTeamList=a.dataInfo:e.$message.error(a.message);case 4:case"end":return t.stop()}},t,e)}))()},search:function(){this.form.pageNumber=1,this.getTableData()},paginationChange:function(e){this.form.pageNumber=e.page,this.form.pageSize=e.limit,this.getTableData()},handleSelectionChange:function(e){this.batchDelIds=e.map(function(e){return e.id})},addChannel:function(){var e=this;s()(this.addForm,this.backupAddForm),this.$nextTick(function(){e.$refs.addForm.clearValidate()}),this.dialogTitle="开启提交通道",this.centerDialogVisible=!0},batchDelete:function(){var e=this;if(!this.batchDelIds.length)return this.$message.warning("请选择删除项");this.$confirm("确定删除所选项吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.deleteRequest(e.batchDelIds)}).catch(function(){})},deleteRequest:function(e){var t=this;return c()(l.a.mark(function a(){var r;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$post("summarizeDelete",{ids:e});case 2:"1000"===(r=a.sent).returnCode?(t.$message.success("删除成功"),t.getTableData()):t.$message.error(r.message);case 4:case"end":return a.stop()}},a,t)}))()},editTableItem:function(e){var t=this;this.dialogTitle="编辑提交设置",this.centerDialogVisible=!0,this.curClickItemIndex=e.$index,this.$nextTick(function(){i()(t.addForm).forEach(function(a){t.addForm[a]=e.row[a]}),console.log("addForm",t.addForm),e.row.informWay?t.addForm.informWayList=e.row.informWay.split(","):t.addForm.informWayList=[],t.addForm.orgIdList=e.row.orgIds.split(",")})},delTableItem:function(e){var t=this;this.curClickItemIndex=e.$index,this.$confirm("此操作将删除管理员 “"+e.row.username+"” , 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.delAdministrator([e.row.userId])}).catch(function(){})},closeDialog:function(e){this.centerDialogVisible=!1,this.$refs[e].clearValidate()},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;"开启提交通道"===t.dialogTitle?t.addChannelRequest():"编辑提交设置"===t.dialogTitle&&t.updateChannelRequest()})},addChannelRequest:function(){var e=this;return c()(l.a.mark(function t(){var a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.addForm.content=e.addForm.title+" 已开启，起止时间："+e.formatTime(e.addForm.eventBegin,"YYYY-MM-DD")+" ~ "+e.formatTime(e.addForm.eventEnd,"YYYY-MM-DD")+"，请及时前往招生干部管理系统提交。",t.next=3,e.$post("summarizeAdd",e.addForm);case 3:"1000"===(a=t.sent).returnCode?(e.centerDialogVisible=!1,e.$message.success("提交成功"),e.getTableData()):e.$message.error(a.message);case 5:case"end":return t.stop()}},t,e)}))()},updateChannelRequest:function(){var e=this;return c()(l.a.mark(function t(){var a,r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.addForm.title+" 提交通道设置已更新，提交时间由："+e.formatTime(e.tableData[e.curClickItemIndex].eventBegin,"YYYY-MM-DD")+" ~ "+e.formatTime(e.tableData[e.curClickItemIndex].eventEnd,"YYYY-MM-DD")+" 调整为 "+e.formatTime(e.addForm.eventBegin,"YYYY-MM-DD")+" ~ "+e.formatTime(e.addForm.eventEnd,"YYYY-MM-DD")+"，请知悉。",t.next=3,e.$post("summarizeUpdate",{id:e.tableData[e.curClickItemIndex].id,title:e.addForm.title,eventBegin:e.addForm.eventBegin,eventEnd:e.addForm.eventEnd,informWayList:e.addForm.informWayList,content:a});case 3:"1000"===(r=t.sent).returnCode?(e.centerDialogVisible=!1,e.$message.success("提交成功"),e.getTableData()):e.$message.error(r.message);case 5:case"end":return t.stop()}},t,e)}))()}}}),u=(a("8zhb"),a("ZrdR")),f=Object(u.a)(m,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"commit_list"},[a("div",{staticClass:"commit_list_wrapper"},[a("el-form",{ref:"form",staticClass:"form",attrs:{model:e.form,"label-width":"150px"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"标题："}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"指定提交对象型："}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",clearable:""},model:{value:e.form.assignObject,callback:function(t){e.$set(e.form,"assignObject",t)},expression:"form.assignObject"}},[a("el-option",{attrs:{label:"全部招生组",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"指定招生组",value:"2"}})],1)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"search_button_row"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.search}},[e._v("搜索")])],1)],1),e._v(" "),a("div",{staticClass:"table_container"},[a("div",{staticClass:"btn_container"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addChannel}},[e._v("开启提交通道")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:e.batchDelete}},[e._v("批量删除")])],1),e._v(" "),a("el-table",{ref:"roleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{prop:"title",label:"标题","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("router-link",{attrs:{to:{path:"/summary/commitRecords/singleRecords",query:{id:t.row.id,title:t.row.title}}}},[e._v(e._s(t.row.title))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"开始时间",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("filterTime")(t.row.eventBegin,"YYYY-MM-DD hh:mm")))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"结束时间",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("filterTime")(t.row.eventEnd,"YYYY-MM-DD hh:mm")))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"指定提交对象"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.replayNumber||"0")+" / "+e._s(t.row.informNumber||"0")+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"反馈情况"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s("1"===t.row.assignObject?"全部招生组":"2"===t.row.assignObject?"指定招生组":"")+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"是否及时通知"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s("1"===t.row.informTimely?"是":"2"===t.row.informTimely?"否":"")+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"address",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("router-link",{attrs:{to:{path:"/summary/commitRecords/feedback",query:{id:t.row.id}}}},[e._v("反馈名单")]),e._v(" "),"1"===t.row.status?a("span",{staticClass:"edit_item",on:{click:function(a){e.editTableItem(t)}}},[e._v("编辑")]):e._e(),e._v(" "),"2"===t.row.status?a("span",{staticClass:"del_item",on:{click:function(a){e.delTableItem(t)}}},[e._v("删除")]):e._e()]}}])})],1)],1),e._v(" "),a("div",{staticClass:"pagination"},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.form.pageNumber,limit:e.form.pageSize},on:{"update:page":function(t){e.$set(e.form,"pageNumber",t)},"update:limit":function(t){e.$set(e.form,"pageSize",t)},pagination:e.paginationChange}})],1),e._v(" "),a("div",{staticClass:"dialog_container"},[a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.centerDialogVisible,center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.rules,"label-width":"150px"}},[a("el-row",[a("el-col",{attrs:{span:21}},[a("el-form-item",{attrs:{label:"标题：",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addForm.title,callback:function(t){e.$set(e.addForm,"title",t)},expression:"addForm.title"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:21}},[a("el-form-item",{attrs:{label:"开始时间：",prop:"eventBegin"}},[a("date-picker",{attrs:{fullWidth:""},model:{value:e.addForm.eventBegin,callback:function(t){e.$set(e.addForm,"eventBegin",t)},expression:"addForm.eventBegin"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:21}},[a("el-form-item",{attrs:{label:"结束时间：",prop:"eventEnd"}},[a("date-picker",{attrs:{fullWidth:"",end:""},model:{value:e.addForm.eventEnd,callback:function(t){e.$set(e.addForm,"eventEnd",t)},expression:"addForm.eventEnd"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:21}},[a("el-form-item",{attrs:{label:"指定提交对象型：",prop:"assignObject"}},[a("el-radio-group",{attrs:{disabled:e.disabled},model:{value:e.addForm.assignObject,callback:function(t){e.$set(e.addForm,"assignObject",t)},expression:"addForm.assignObject"}},[a("el-radio",{attrs:{label:"1"}},[e._v("全部招生组")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("指定招生组")])],1)],1)],1)],1),e._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:"2"===e.addForm.assignObject,expression:"addForm.assignObject === '2'"}]},[a("el-col",{attrs:{span:21}},[a("el-form-item",{attrs:{label:"指定提交对象：",prop:"2"===e.addForm.assignObject?"orgIdList":""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入名称模糊搜索",filterable:"",multiple:"",clearable:"",disabled:e.disabled},model:{value:e.addForm.orgIdList,callback:function(t){e.$set(e.addForm,"orgIdList",t)},expression:"addForm.orgIdList"}},e._l(e.admissionsTeamList,function(e){return a("el-option",{key:e.id,attrs:{label:e.groupName,value:e.id}})}))],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:21}},[a("el-form-item",{attrs:{label:"提示方式：",prop:"informWayList"}},[a("el-checkbox-group",{attrs:{disabled:e.disabled},model:{value:e.addForm.informWayList,callback:function(t){e.$set(e.addForm,"informWayList",t)},expression:"addForm.informWayList"}},[a("el-checkbox",{attrs:{label:"1"}},[e._v("短信")]),e._v(" "),a("el-checkbox",{attrs:{label:"2"}},[e._v("微信")])],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:21}},[a("el-form-item",{attrs:{label:"是否及时通知：",prop:"informTimely"}},[a("el-radio-group",{attrs:{disabled:e.disabled},model:{value:e.addForm.informTimely,callback:function(t){e.$set(e.addForm,"informTimely",t)},expression:"addForm.informTimely"}},[a("el-radio",{attrs:{label:"2"}},[e._v("否")]),e._v(" "),a("el-radio",{attrs:{label:"1"}},[e._v("是")])],1)],1)],1)],1),e._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:"1"===e.addForm.informTimely,expression:"addForm.informTimely === '1'"}]},[a("el-col",{attrs:{span:21}},[a("el-form-item",{attrs:{label:"提示时间：",prop:"1"===e.addForm.informTimely?"hintTime":""}},[a("date-picker",{attrs:{fullWidth:"",disabled:e.disabled},model:{value:e.addForm.hintTime,callback:function(t){e.$set(e.addForm,"hintTime",t)},expression:"addForm.hintTime"}})],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.closeDialog("addForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("addForm")}}},[e._v("确 定")])],1)],1)],1)],1)])},[],!1,null,"d83e34d4",null);f.options.__file="commitList.vue";t.default=f.exports},"7lJm":function(e,t,a){},"8zhb":function(e,t,a){"use strict";var r=a("7lJm");a.n(r).a}}]);